<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard NPS - Vegas Vigil√¢ncia</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }

    body {
      background-color: #111;
      color: #fff;
      margin: 0;
      padding: 0;
    }

    header {
      background: linear-gradient(90deg, #333, #000);
      padding: 20px;
      text-align: center;
      font-size: 1.8rem;
      font-weight: 600;
      letter-spacing: 1px;
    }

    .top-bar {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      padding: 15px;
      background: #1a1a1a;
    }

    .top-bar input, .top-bar select {
      padding: 10px;
      border: none;
      border-radius: 6px;
      font-size: 0.95rem;
      outline: none;
    }

    .top-bar input {
      width: 220px;
    }

    main {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 15px;
    }

    .card {
      background: #1f1f1f;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .card:hover {
      transform: scale(1.03);
      box-shadow: 0 0 15px rgba(255,255,255,0.1);
    }

    .nota {
      font-size: 2.5rem;
      font-weight: bold;
      text-align: center;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .comentario {
      font-size: 0.95rem;
      color: #ccc;
      margin-top: 8px;
      line-height: 1.4;
    }

    .extras {
      font-size: 0.9rem;
      color: #999;
      margin-top: 10px;
      border-top: 1px solid #333;
      padding-top: 8px;
    }

    .footer {
      text-align: center;
      padding: 15px;
      background: #1a1a1a;
      color: #777;
      font-size: 0.9rem;
      margin-top: 30px;
    }

    /* Cores por nota */
    .n1, .n2 { background: #ff2b2b; color: #fff; }
    .n3, .n4 { background: #ff6f00; color: #fff; }
    .n5, .n6 { background: #ffd600; color: #000; }
    .n7, .n8 { background: #64dd17; color: #000; }
    .n9, .n10 { background: #00c853; color: #fff; }
  </style>
</head>
<body>
  <header>Dashboard de Satisfa√ß√£o - Vegas Vigil√¢ncia</header>

  <div class="top-bar">
    <input type="text" id="buscaNome" placeholder="üîç Buscar por nome...">
    <input type="text" id="buscaProduto" placeholder="üîç Buscar por produto...">
    <select id="filtroNota">
      <option value="">Filtrar por nota</option>
      
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="7">7</option>
      <option value="8">8</option>
      <option value="9">9</option>
      <option value="10">10</option>
    </select>
  </div>

  <main id="cardsContainer">
    <p style="text-align:center; color:#888;">Carregando respostas...</p>
  </main>

  <div class="footer">¬© 2025 Vegas Vigil√¢ncia - Dashboard NPS</div>

  <script>
    // üß© Substitua pelo link do seu Google Apps Script (terminando em /exec)
    const API_URL = "https://script.google.com/macros/s/AKfycbyiGedsPHMibL87lObnRy_nKfHWxhhIOd1gJG14A1fkilz9Mw9dCGaJsxciYsbMIfZGbA/exec";

    let respostasOriginais = [];

    async function carregarRespostas() {
      try {
        const res = await fetch(API_URL);
        if (!res.ok) throw new Error("Erro na resposta do servidor");
        const dados = await res.json();

        respostasOriginais = dados.reverse().map(item => ({
          nota: Number(item.nota),
          nome: item.nome?.trim() || "Sem nome",
          telefone: item.telefone || "-",
          produtos: item.produtos || "N√£o informado",
          comentarios: item.comentarios || "Sem coment√°rio"
        }));

        preencherComentarios(respostasOriginais);
      } catch (err) {
        document.getElementById("cardsContainer").innerHTML =
          `<p style="color:red;text-align:center;">Erro ao carregar dados: ${err.message}</p>`;
      }
    }

    function preencherComentarios(lista) {
      const container = document.getElementById("cardsContainer");
      container.innerHTML = "";

      if (lista.length === 0) {
        container.innerHTML = `<p style="text-align:center;color:#888;">Nenhum resultado encontrado.</p>`;
        return;
      }

      lista.forEach(r => {
        const div = document.createElement("div");
        div.classList.add("card");
        div.innerHTML = `
          <div class="nota n${r.nota}">${r.nota}</div>
          <strong>${r.nome}</strong>
          <div class="comentario">${r.comentarios}</div>
          <div class="extras">
            Tel: ${r.telefone}<br>
            Produto(s): ${r.produtos}
          </div>
        `;
        container.appendChild(div);
      });
    }

    function aplicarFiltros() {
      const nomeFiltro = document.getElementById("buscaNome").value.toLowerCase();
      const produtoFiltro = document.getElementById("buscaProduto").value.toLowerCase();
      const notaFiltro = document.getElementById("filtroNota").value;

      let filtradas = respostasOriginais;

      if (nomeFiltro)
        filtradas = filtradas.filter(r => r.nome.toLowerCase().includes(nomeFiltro));

      if (produtoFiltro)
        filtradas = filtradas.filter(r => r.produtos.toLowerCase().includes(produtoFiltro));

      if (notaFiltro !== "")
        filtradas = filtradas.filter(r => r.nota == notaFiltro);

      preencherComentarios(filtradas);
    }

    document.getElementById("buscaNome").addEventListener("input", aplicarFiltros);
    document.getElementById("buscaProduto").addEventListener("input", aplicarFiltros);
    document.getElementById("filtroNota").addEventListener("change", aplicarFiltros);

    carregarRespostas();
  </script>
</body>
</html>
